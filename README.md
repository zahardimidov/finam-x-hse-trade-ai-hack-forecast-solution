# Finam-X-HSE Trade AI Hackathon

## Описание задачи

Цель хакатона — создать модель, которая прогнозирует доходности акций на основе исторических котировок и новостей.

MVP должен уметь:

* Принимать срез данных на конец дня (t) (цены и новости до (t) включительно)
* Возвращать для каждого тикера:

  * **r_{t+1}** — прогноз доходности на следующий день
  * **R_{t+20}** — прогноз суммарной доходности за 20 торговых дней

Функциональные требования MVP:

* Два режима работы:

  * **train** — обучение на train/val и сохранение артефактов
  * **predict** — инференс на test-срезе с сохранёнными артефактами
* Генерация CSV с предсказаниями
* Работа с произвольным числом тикеров на входе
* Максимальная воспроизводимость (фиксированный seed)
* Время выполнения train + predict ≤ 60 минут

---

## Данные

### Котировки

* `candles.csv`: с 2020-06-19 по 2025-06-18

Поля:
`open, close, high, low, volume, begin, ticker`

### Новости

* `news.csv`: с 2020-01-01 по 2025-07-18

Поля:
`publish_date, title, publication`

Обработка новостей: объединение `title` и `publication` в одну колонку `text`.

---

## Предобработка данных

### Котировки

1. Разбиваем данные каждого тикера на **непрерывные интервалы недель**, где есть все дни с понедельника по пятницу.
2. Генерируем **технические индикаторы** и дополнительные признаки:

```
['weekday', 'return_1d', 'log_return', 'SMA_3', 'EMA_3', 'volatility_3', 
 'momentum_3', 'SMA_5', 'EMA_5', 'volatility_5', 'momentum_5', 
 'SMA_10', 'EMA_10', 'volatility_10', 'momentum_10', 'RSI_7', 
 'MACD', 'MACD_signal', 'bollinger_upper', 'bollinger_lower', 
 'bollinger_bandwidth', 'ATR_7', 'volume_mean_3', 'volume_change_3', 
 'volume_mean_5', 'volume_change_5', 'volume_mean_10', 'volume_change_10', 
 'distance_from_SMA_3', 'distance_from_SMA_5']
```

### Новости

1. Создан словарь ключевых слов для сопоставления новости с тикером.
2. Для каждой новости вычислен список тикеров, которые она затрагивает (`all_tickers`).
3. **TF-IDF + SVD для текстового представления новостей:**

   * **TF-IDF (Term Frequency–Inverse Document Frequency)** — оценивает важность слова в тексте относительно всех текстов. Позволяет выделить значимые слова для каждой новости, убирая шум от часто встречающихся слов.
   * **SVD (Truncated Singular Value Decomposition)** — уменьшает размерность TF-IDF векторов, оставляя ключевые семантические признаки текста.

4. **Агрегация по тикеру и дате публикации:**
   Средние значения SVD-признаков для каждой пары (ticker, publish_date).

5. **Новизна новости (novelty):**
   Косинусное расстояние между вектором текущей новости и средним вектором всех предыдущих новостей того же тикера. Позволяет учитывать, насколько новая информация отличается от уже известной.

---

## Формирование признаков для модели

Для каждой свечи:

* Находим соответствующие новости (ticker в `all_tickers` и `publish_date = date`)
* Вычисляем агрегированные признаки по новостям за последние дни:

  * Количество новостей (`news_count_1`, `news_count_5`)
  * Средняя, максимальная и стандартное отклонение новизны (`news_novelty_mean_1`, `news_novelty_max_1`, `news_novelty_std_1`, …)

Таким образом, каждая дата для каждого тикера получает **сочетание временных и новостных признаков**, готовое для обучения модели.

---

## Модель

1. Модель обучается на интервалах свечей каждого тикера.
2. На выходе прогнозирует доходности на горизонты от 1 до 20 дней:

[
R_{t+N} = \frac{close_{t+N}}{close_t} - 1
]

3. Формируется CSV с предсказаниями для тестового периода:

```
ticker,p1,p2,p3,...,p20
```

---

## Резюме

* **Данные:** котировки и новости с 2020 по 2025 годы.
* **Предобработка:** индикаторы для свечей, сопоставление новостей с тикерами, TF-IDF + SVD, новизна новостей.
* **Модель:** прогноз доходностей на горизонты 1–20 дней.
* **Выход:** CSV с предсказаниями, совместимый с оценочным скриптом.
# finam-x-hse-trade-ai-hack-forecast-solution
# finam-x-hse-trade-ai-hack-forecast-solution
# finam-x-hse-trade-ai-hack-forecast-solution
# finam-x-hse-trade-ai-hack-forecast-solution
